---
title: Registering Plugins
description: Configure and register plugins in your UDL application
navigation:
  icon: i-lucide-settings
---

## Registering Plugins

To use plugins in your Universal Data Layer application, you need to register them in your application's `udl.config.js` file.

## Application Configuration

Create a `udl.config.js` file in your project root:

```javascript
// udl.config.js
export const config = {
  port: 4000,
  host: 'localhost',
  plugins: [
    // Register your plugins here
  ],
};
```

## Plugin Registration Methods

### Method 1: Simple String (Package Name)

Register an npm package by name. First, install the plugin:

```bash
npm install @universal-data-layer/contentful
```

Then register it in your config:

```javascript
export const config = {
  plugins: [
    '@universal-data-layer/contentful',
  ],
};
```

### Method 2: Object with Options

Pass configuration options to your plugin:

```javascript
export const config = {
  plugins: [
    {
      name: '@universal-data-layer/contentful',
      options: {
        spaceId: 'your-space-id',
        accessToken: process.env.CONTENTFUL_ACCESS_TOKEN,
        environment: 'master',
      },
    },
  ],
};
```

The `options` object is passed to the plugin's `onLoad` hook.

### Method 3: Local File Path

Use a local plugin via relative or absolute path:

```javascript
export const config = {
  plugins: [
    './plugins/my-local-plugin',           // Relative path
    '/absolute/path/to/plugin',            // Absolute path
  ],
};
```

With options:

```javascript
export const config = {
  plugins: [
    {
      name: './plugins/my-local-plugin',
      options: {
        customSetting: 'value',
      },
    },
  ],
};
```

## Configuration Examples

### Basic Configuration

```javascript
// udl.config.js
export const config = {
  port: 4000,
  host: 'localhost',
  plugins: [
    '@universal-data-layer/contentful',
  ],
};
```

### Multiple Plugins with Options

```javascript
// udl.config.js
export const config = {
  port: 4000,
  host: 'localhost',
  plugins: [
    {
      name: '@universal-data-layer/contentful',
      options: {
        spaceId: process.env.CONTENTFUL_SPACE_ID,
        accessToken: process.env.CONTENTFUL_ACCESS_TOKEN,
        host: 'preview.contentful.com', // Use preview API
      },
    },
    {
      name: '@universal-data-layer/shopify',
      options: {
        shop: process.env.SHOPIFY_SHOP,
        accessToken: process.env.SHOPIFY_ACCESS_TOKEN,
        apiVersion: '2024-01',
      },
    },
    {
      name: './plugins/custom-cache',
      options: {
        ttl: 3600,
        strategy: 'lru',
      },
    },
  ],
};
```

### Using Environment Variables

Create a `.env` file:

```bash
# .env
CONTENTFUL_SPACE_ID=your-space-id
CONTENTFUL_ACCESS_TOKEN=your-access-token
CONTENTFUL_ENV=master
```

```javascript
// udl.config.js
export const config = {
  port: parseInt(process.env.PORT || '4000', 10),
  host: process.env.HOST || 'localhost',
  plugins: [
    {
      name: '@universal-data-layer/contentful',
      options: {
        spaceId: process.env.CONTENTFUL_SPACE_ID,
        accessToken: process.env.CONTENTFUL_ACCESS_TOKEN,
        environment: process.env.CONTENTFUL_ENV || 'master',
      },
    },
  ],
};
```

## Application Lifecycle Hook

You can also define an `onLoad` hook in your application config:

```javascript
// udl.config.js
export const config = {
  port: 4000,
  plugins: [
    '@universal-data-layer/contentful',
  ],
};

export function onLoad({ options, config }) {
  console.log('Application config loaded');
  console.log('Registered plugins:', config.plugins);

  // Perform app-level initialization
}
```

## Plugin Loading Order

Plugins are loaded in the order they appear in the `plugins` array:

```javascript
export const config = {
  plugins: [
    'plugin-one',    // Loaded first
    'plugin-two',    // Loaded second
    'plugin-three',  // Loaded third
  ],
};
```

This matters if plugins have dependencies on each other.

## Conditional Plugin Loading

Load plugins conditionally based on environment:

```javascript
const isDevelopment = process.env.NODE_ENV === 'development';
const isProduction = process.env.NODE_ENV === 'production';

export const config = {
  port: 4000,
  plugins: [
    '@universal-data-layer/contentful',
    ...(isDevelopment ? ['./plugins/dev-logger'] : []),
    ...(isProduction ? ['./plugins/analytics'] : []),
  ],
};
```

## TypeScript Configuration

For TypeScript projects, use `.ts` or `.mts` extension:

```typescript
// udl.config.ts
import type { UDLConfig } from 'universal-data-layer';

export const config: UDLConfig = {
  port: 4000,
  host: 'localhost',
  plugins: [
    {
      name: '@universal-data-layer/contentful',
      options: {
        spaceId: process.env.CONTENTFUL_SPACE_ID || '',
        accessToken: process.env.CONTENTFUL_ACCESS_TOKEN || '',
      },
    },
  ],
};
```

## Supported Config File Names

UDL looks for configuration files in this order:

1. `udl.config.js`
2. `udl.config.mjs`
3. `udl.config.cjs`

## Starting the Server

Once configured, start your server:

```bash
# Using npx
npx universal-data-layer

# Or if installed globally
universal-data-layer

# Or if installed locally and added to scripts (like "udl": "universal-data-layer")
npm run udl
```

The server will:
1. Load your application config
2. Initialize registered plugins in order
3. Execute each plugin's `onLoad` hook
4. Start the GraphQL server

## Troubleshooting

### Plugin Not Found

If you get "Plugin not found" errors:

1. Check the plugin name spelling
2. Ensure the plugin is installed (`npm install udl-plugin-name`)
3. For local plugins, verify the path is correct
4. Check that the plugin has a `udl.config.js` file

### Options Not Received

If your plugin doesn't receive options:

1. Verify you're using object syntax with `name` and `options`
2. Check that options is not `undefined` in the plugin's `onLoad`
3. Ensure the options object matches what the plugin expects

### Load Order Issues

If plugins fail due to dependencies:

1. Reorder plugins in the `plugins` array
2. Ensure dependent plugins load after their dependencies
3. Consider using the `onLoad` hook to handle initialization order

## Next Steps

- [Lifecycle Methods](/plugins/lifecycle-methods) - Deep dive into plugin lifecycle
- [Creating a Plugin](/plugins/creating-plugins) - Build your own plugin
